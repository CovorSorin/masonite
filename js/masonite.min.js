/*! masonite.min.js v0.2.4 2013-07-29 */
(function(t,i){"use strict";function e(){if(masonite.googlePrettify){var t=!1;i("pre code").parent().each(function(){i(this).hasClass("prettyprint")||(i(this).addClass("prettyprint"),t=!0)}),t&&prettyPrint()}}function o(){var t=i("#header, #copyright"),e=.5;t.css("opacity",e),t.mouseenter(function(){t.stop().animate({opacity:1},250)}).mouseleave(function(){0===i("#header input:focus").length&&t.stop().animate({opacity:e},250)})}i.fn.fixYouTube=function(){return this.find("embed[src^='http://www.youtube.com']").each(function(){var t,e=i(this).closest("object"),o=e.html(),a="",s=/rel=0/g,n=i(this).attr("src"),r=/\/v\/([0-9A-Za-z-_]*)/,c=n.match(r),l=Math.floor(.75*e.width()+25-3),d=Math.floor(.5625*e.width()+25-3);e.css("visibility","hidden"),-1===o.toLowerCase().indexOf("<param")&&i("param",this).each(function(){a+=i(this).get(0).outerHTML}),t="rel=0&amp;color1=0x"+masonite.whites+"&amp;color2=0x"+masonite.whites,o=o.replace(s,t),""!==a&&(a=a.replace(s,t),o=o.replace(/<embed/i,a+"<embed")),i.getJSON("http://gdata.youtube.com/feeds/api/videos/"+c[1]+"?v=2&alt=json-in-script&callback=?",function(i){s=/height="?([0-9]*)"?/g,t=null!=i.entry.media$group.yt$aspectRatio?'height="'+d+'"':'height="'+l+'"',o=o.replace(s,t),""!==a&&(a=a.replace(s,t),o=o.replace(/<embed/i,a+"<embed")),e.html(o).css("visibility","visible")})}),this},i.fn.fixSoundcloud=function(){return this.find("iframe[src^='https://w.soundcloud.com/']").each(function(){var t=i(this),e=(t.attr("src"),t.prop("attributes")),o=i("<iframe></iframe>").insertAfter(t).hide();t.remove(),o.show(),i.each(e,function(){"src"===this.name?o.attr(this.name,this.value+"&color="+masonite.accents):o.attr(this.name,this.value)})}),this},i.fn.fixVimeo=function(){var t="title=0&byline=0&portrait=0";return this.find("iframe[src^='http://player.vimeo.com']").each(function(){var e=i(this).attr("src"),o=i(this).attr("width"),a=i(this).attr("height");-1===e.indexOf("?")&&i(this).replaceWith("<iframe src='"+e+"?"+t+"&color="+masonite.accents+"' width='"+o+"' height='"+a+"' frameborder='0'></iframe>")}),this.find("object[data^='http://vimeo.com']").each(function(){var e=i(this),o=e.attr("data"),a=o.split("clip_id=")[1],s=a.split("&")[0],n=a.split("&")[1],r=e.attr("width"),c=e.attr("height");e.replaceWith("<iframe src='http://player.vimeo.com/video/"+s+"?"+n+"&"+t+"&color="+masonite.accents+"' width='"+r+"' height='"+c+"' frameborder='0'></iframe>")}),this},i.fn.initColorbox=function(){return masonite.colorbox&&this.find("a.fullsize").colorbox(masonite.colorboxOptions),this},i.fn.disqusCommentCount=function(){if(masonite.disqusShortname){var t="http://disqus.com/forums/"+masonite.disqusShortname+"/count.js";i.getScript(t)}return this},i.fn.fixTumblrAudio=function(){return this.each(function(){if(i(this).hasClass("audio")){var t=i(this),e=t.attr("id"),o=document.createElement("script");t.find(".player span").css({visibility:"hidden"}),o.type="text/javascript",o.src="http://assets.tumblr.com/javascript/tumblelog.js?16",i("body").append(o),i.ajax({url:"/api/read/json?id="+e,dataType:"jsonp",timeout:5e3,success:function(i){t.find(".player span").css({visibility:"visible"});var o=i.posts[0]["audio-player"].replace("audio_player.swf","audio_player"+masonite.audioPlayerColor+".swf");t.find("span:first").append('<script type="text/javascript">replaceIfFlash(9,"audio_player_'+e+'",\'<div class="audio_player">'+o+"</div>')</script>")}})}}),this},i(function(){if(i("#avatar").imagesLoaded(function(){var t=i("#avatar"),e=t.width(),o=t.attr("data-hidpi-src"),a=t.attr("src");""!==o&&(t.attr("src",o).attr("width",e),t.one("error",function(){this.src=a}))}),masonite.fadeSidebar&&!Modernizr.touch&&o(),i("#likes").masonry({isAnimated:!Modernizr.csstransitions,itemSelector:"li",isResizable:!0,columnWidth:i("li").width()}),masonite.colorbox&&(masonite.colorboxOptions={opacity:.92,slideshow:!0,slideshowAuto:!1,speed:200,photo:!0,fixed:!0,maxWidth:"90%",maxHeight:"90%"},i(document).on("cbox_open",function(){i("body").css({overflow:"hidden"})}).on("cbox_cleanup",function(){i("body").css({overflow:"auto"})})),i(".post").initColorbox().disqusCommentCount().find('embed[src*="assets.tumblr.com/swf/audio_player"]').addClass("fit-vids-ignore").end().fixYouTube().fitVids().fixVimeo().fixSoundcloud(),e(),i(".title").widowFix(),i("body").hasClass("index")){var a,s=i("#posts");masonite.likeLinks&&(i("body").append('<iframe id="like"></iframe>'),i(".footer").on({click:function(t){t.preventDefault();var e=i(this).closest(".post"),o=e.attr("id"),a=e.attr("rel").slice(-8),s=i(this).hasClass("liked"),n=s?"unlike":"like",r="http://www.tumblr.com/"+n+"/"+a+"?id="+o;i("#like").attr("src",r),i(this).toggleClass("liked")}},".like a")),i("body").hasClass("single-column")||s.imagesLoaded(function(){if(s.masonry({itemSelector:".post",isFitWidth:masonite.centeredContent,isResizeBound:!masonite.centeredContent,columnWidth:i(".post").outerWidth(!0)}),masonite.centeredContent){var e=i("#container"),o=i("#header").outerWidth(!1),a=i("#header, #copyright"),n=i(".post:first"),r=n.outerWidth(!0),c=r-n.width(),l=null,d=!1;i(t).on("debouncedresize",function(){var t=Math.floor((i("body").width()-o-2*c)/r);if(t!==l&&t>0){d=t>l?!0:!1,l=t;var n;d?(n=i("body").hasClass("header-left")?i("#posts, #container"):i("#header, #copyright, #posts, #container"),e.animate({width:l*r+o},100),i("body").hasClass("header-left")||a.animate({"margin-left":l*r},100),n.promise().done(function(){s.masonry("layout"),i("#likes").masonry("layout")})):(e.width(l*r+o),s.masonry("layout"),i("#likes").masonry("layout"),i("body").hasClass("header-left")||a.css({"margin-left":l*r}))}}),i(t).trigger("debouncedresize")}}),masonite.infiniteScroll&&(masonite.infiniteScrollLoadingOptions={finishedMsg:"No more pages to load",img:"http://static.tumblr.com/wccjej0/SzLlinacm/ajax-loader.gif",msgText:"Loading 2/"+masonite.totalPages},masonite.customTrigger?(a="twitter",i("#pagination li.next a").text("Load more posts")):masonite.infiniteScrollLoadingOptions.selector="#copyright",s.infinitescroll({loading:masonite.infiniteScrollLoadingOptions,navSelector:"#pagination",nextSelector:"#pagination .next a",itemSelector:"#posts .post",bufferPx:600,behavior:a,maxPage:masonite.totalPages,errorCallback:function(){i("#infscr-loading").animate({opacity:.8},2e3).fadeOut("normal")}},function(t){var o=s.data("infinitescroll").options,a=i(t).css({opacity:0});a.initColorbox().disqusCommentCount().fixYouTube().fitVids().fixVimeo().fixSoundcloud().fixTumblrAudio().find(".title").widowFix(),e(),a.imagesLoaded(function(){i("body").hasClass("single-column")?a.animate({opacity:1},200,"swing"):(s.masonry("appended",t),a.animate({opacity:1},200,"swing")),masonite.customTrigger&&i("#pagination li.next a").fadeIn({duration:200,easing:"easeInOutCubic"})}),setTimeout(function(){var t=i("#infscr-loading > div");o.state.currPage+1<=masonite.totalPages?t.html("Loading "+(o.state.currPage+1)+"/"+masonite.totalPages):t.html("No more pages to load")},400)}))}})})(window,jQuery);