(function(a,b){"use strict";function d(){if(masonite.googlePrettify){var a=!1;b("pre code").parent().each(function(){b(this).hasClass("prettyprint")||(b(this).addClass("prettyprint"),a=!0)}),a&&prettyPrint()}}function e(){var a=b("#header, #copyright"),c=.5;a.css("opacity",c),a.mouseenter(function(){a.stop().animate({opacity:1},250)}).mouseleave(function(){0===b("#header input:focus").length&&a.stop().animate({opacity:c},250)})}b.fn.fixYouTube=function(){return this.find("embed[src^='http://www.youtube.com']").each(function(){var f,a=b(this).closest("object"),c=a.html(),d="",e=/rel=0/g,g=b(this).attr("src"),h=/\/v\/([0-9A-Za-z-_]*)/,i=g.match(h),j=Math.floor(.75*a.width()+25-3),k=Math.floor(.5625*a.width()+25-3);a.css("visibility","hidden"),-1===c.toLowerCase().indexOf("<param")&&b("param",this).each(function(){d+=b(this).get(0).outerHTML}),f="rel=0&amp;color1=0x"+masonite.whites+"&amp;color2=0x"+masonite.whites,c=c.replace(e,f),""!==d&&(d=d.replace(e,f),c=c.replace(/<embed/i,d+"<embed")),b.getJSON("http://gdata.youtube.com/feeds/api/videos/"+i[1]+"?v=2&alt=json-in-script&callback=?",function(b){e=/height="?([0-9]*)"?/g,f=null!=b.entry.media$group.yt$aspectRatio?'height="'+k+'"':'height="'+j+'"',c=c.replace(e,f),""!==d&&(d=d.replace(e,f),c=c.replace(/<embed/i,d+"<embed")),a.html(c).css("visibility","visible")})}),this},b.fn.fixVimeo=function(){var a=masonite.accents,c="title=0&byline=0&portrait=0";return this.find("iframe[src^='http://player.vimeo.com']").each(function(){var d=b(this).attr("src"),e=b(this).attr("width"),f=b(this).attr("height");-1===d.indexOf("?")&&b(this).replaceWith("<iframe src='"+d+"?"+c+"&color="+a+"' width='"+e+"' height='"+f+"' frameborder='0'></iframe>")}),this.find("object[data^='http://vimeo.com']").each(function(){var d=b(this),e=d.attr("data"),f=e.split("clip_id=")[1],g=f.split("&")[0],h=f.split("&")[1],i=d.attr("width"),j=d.attr("height");d.replaceWith("<iframe src='http://player.vimeo.com/video/"+g+"?"+h+"&"+c+"&color="+a+"' width='"+i+"' height='"+j+"' frameborder='0'></iframe>")}),this},b.fn.initColorbox=function(){return masonite.colorbox&&this.find("a.fullsize").colorbox(masonite.colorboxOptions),this},b.fn.disqusCommentCount=function(){if(masonite.disqusShortname){var a="http://disqus.com/forums/"+masonite.disqusShortname+"/count.js";b.getScript(a)}return this},b.fn.fixTumblrAudio=function(){return this.each(function(){if(b(this).hasClass("audio")){var a=b(this),c=a.attr("id"),d=document.createElement("script");a.find(".player span").css({visibility:"hidden"}),d.type="text/javascript",d.src="http://assets.tumblr.com/javascript/tumblelog.js?16",b("body").append(d),b.ajax({url:"/api/read/json?id="+c,dataType:"jsonp",timeout:5e3,success:function(b){a.find(".player span").css({visibility:"visible"});var d=b.posts[0]["audio-player"].replace("audio_player.swf","audio_player"+masonite.audioPlayerColor+".swf");a.find("span:first").append('<script type="text/javascript">replaceIfFlash(9,"audio_player_'+c+'",\'<div class="audio_player">'+d+"</div>')</script>")}})}}),this},b(function(){if(b("#avatar").imagesLoaded(function(){var a=b(this),c=a.width(),d=a.attr("data-hidpi-src"),e=a.attr("src");""!==d&&(a.attr("src",d).attr("width",c),a.one("error",function(){this.src=e}))}),masonite.fadeSidebar&&!Modernizr.touch&&e(),b("#likes").masonry({isAnimated:!Modernizr.csstransitions,itemSelector:"li",isResizable:!0,columnWidth:b("li").width()}),masonite.colorbox&&(masonite.colorboxOptions={opacity:.92,slideshow:!0,slideshowAuto:!1,speed:200,photo:!0,fixed:!0,maxWidth:"90%",maxHeight:"90%"},b(document).on("cbox_open",function(){b("body").css({overflow:"hidden"})}).on("cbox_cleanup",function(){b("body").css({overflow:"auto"})})),b(".post").initColorbox().disqusCommentCount().find('embed[src*="assets.tumblr.com/swf/audio_player"]').addClass("fit-vids-ignore").end().fixYouTube().fitVids().fixVimeo(),d(),b(".title").widowFix(),b("body").hasClass("index")){var f,c=b("#posts");masonite.likeLinks&&(b("body").append('<iframe id="like"></iframe>'),b(".footer").on({click:function(a){a.preventDefault();var c=b(this).closest(".post"),d=c.attr("id"),e=c.attr("rel").slice(-8),f=b(this).hasClass("liked"),g=f?"unlike":"like",h="http://www.tumblr.com/"+g+"/"+e+"?id="+d;b("#like").attr("src",h),b(this).toggleClass("liked")}},".like a")),b("body").hasClass("single-column")||c.imagesLoaded(function(){if(c.masonry({isAnimated:!Modernizr.csstransitions,itemSelector:".post",isFitWidth:masonite.centeredContent,isResizable:!masonite.centeredContent,columnWidth:b(".post").outerWidth(!0)}),masonite.centeredContent){var d=b("#container"),e=b("#header").outerWidth(!1),f=b("#header, #copyright"),g=b(".post:first"),h=g.outerWidth(!0),i=h-g.width(),j=null,k=!1;b(a).smartresize(function(){var a=Math.floor((b("body").width()-e-2*i)/h);if(a!==j&&a>0){k=a>j?!0:!1,j=a;var g;k?(g=b("body").hasClass("header-left")?b("#posts, #container"):b("#header, #copyright, #posts, #container"),d.animate({width:j*h+e},100),b("body").hasClass("header-left")||f.animate({"margin-left":j*h},100),g.promise().done(function(){c.masonry("reload"),b("#likes").masonry("reload")})):(d.width(j*h+e),c.masonry("reload"),b("#likes").masonry("reload"),b("body").hasClass("header-left")||f.css({"margin-left":j*h}))}}).smartresize()}}),masonite.infiniteScroll&&(masonite.infiniteScrollLoadingOptions={finishedMsg:"No more pages to load",img:"http://static.tumblr.com/wccjej0/SzLlinacm/ajax-loader.gif",msgText:"Loading 2/"+masonite.totalPages},masonite.customTrigger?(f="twitter",b("#pagination li.next a").text("Load more posts")):masonite.infiniteScrollLoadingOptions.selector="#copyright",c.infinitescroll({loading:masonite.infiniteScrollLoadingOptions,navSelector:"#pagination",nextSelector:"#pagination .next a",itemSelector:"#posts .post",bufferPx:200,behavior:f,maxPage:masonite.totalPages,errorCallback:function(){b("#infscr-loading").animate({opacity:.8},2e3).fadeOut("normal")}},function(a){var e=c.data("infinitescroll").options,f=b(a).css({opacity:0});f.initColorbox().disqusCommentCount().fixYouTube().fitVids().fixVimeo().fixTumblrAudio().find(".title").widowFix(),d(),f.imagesLoaded(function(){b("body").hasClass("single-column")?f.animate({opacity:1},200,"swing"):c.masonry("appended",f,!0,function(){f.animate({opacity:1},200,"swing")}),masonite.customTrigger&&b("#pagination li.next a").fadeIn({duration:200,easing:"easeInOutCubic"})}),setTimeout(function(){var a=b("#infscr-loading > div");e.state.currPage+1<=masonite.totalPages?a.html("Loading "+(e.state.currPage+1)+"/"+masonite.totalPages):a.html("No more pages to load")},400)}))}})})(window,jQuery);